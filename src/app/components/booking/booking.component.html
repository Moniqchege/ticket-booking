<div class="booking-container py-5" *ngIf="busRoute">
    <div class="container">
      <div class="row">
        <div class="col-md-8">
          <div class="card shadow">
            <div class="card-header bg-primary text-white">
              <h3 class="mb-0">Booking Details</h3>
            </div>
            <div class="card-body">
              <div *ngIf="!bookingSuccess; else successTemplate">
                <form (ngSubmit)="onSubmit()">
                  <div class="mb-4">
                    <h5>Route Information</h5>
                    <div class="route-info p-3 bg-light rounded">
                      <div class="row">
                        <div class="col-md-6">
                          <strong>{{ busRoute.origin }} to {{ busRoute.destination }}</strong><br>
                          <small class="text-muted">{{ busRoute.busOperator }}</small>
                        </div>
                        <div class="col-md-3">
                          <strong>Departure:</strong> {{ busRoute.departureTime }}<br>
                          <small class="text-muted">{{ busRoute.date | date }}</small>
                        </div>
                        <div class="col-md-3">
                          <strong>Arrival:</strong> {{ busRoute.arrivalTime }}<br>
                          <small class="text-muted">Estimated</small>
                        </div>
                      </div>
                    </div>
                  </div>
  
                  <h5 class="mb-3">Passenger Information</h5>
                  <div class="mb-3">
                    <label for="passengerName" class="form-label">Full Name</label>
                    <input type="text" class="form-control" id="passengerName" 
                           [(ngModel)]="bookingData.passengerName" name="passengerName" required>
                  </div>
                  <div class="mb-3">
                    <label for="passengerEmail" class="form-label">Email</label>
                    <input type="email" class="form-control" id="passengerEmail" 
                           [(ngModel)]="bookingData.passengerEmail" name="passengerEmail" required>
                  </div>
                  <div class="mb-3">
                    <label for="passengerPhone" class="form-label">Phone Number</label>
                    <input type="tel" class="form-control" id="passengerPhone" 
                           [(ngModel)]="bookingData.passengerPhone" name="passengerPhone" required>
                  </div>
                  <div class="mb-4">
                    <label for="seatsBooked" class="form-label">Number of Seats</label>
                    <input type="number" class="form-control" id="seatsBooked" 
                           [(ngModel)]="bookingData.seatsBooked" name="seatsBooked" 
                           min="1" [max]="maxSeats" required>
                    <div class="form-text">Available seats: {{ maxSeats }}</div>
                  </div>
  
                  <div class="d-grid">
                    <button type="submit" class="btn btn-primary btn-lg" [disabled]="isSubmitting">
                      <span *ngIf="!isSubmitting">Confirm Booking</span>
                      <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
                    </button>
                  </div>
                </form>
              </div>
  
              <ng-template #successTemplate>
                <div class="text-center py-4">
                  <div class="success-icon mb-3">
                    <i class="fas fa-check-circle fa-5x text-success"></i>
                  </div>
                  <h3 class="mb-3">Booking Confirmed!</h3>
                  <p class="lead">Your booking ID is: <strong>{{ bookingId }}</strong></p>
                  <p>We've sent a confirmation to your email.</p>
                  <div class="d-grid gap-2 d-md-block">
                    <button class="btn btn-primary me-md-2" (click)="router.navigate(['/my-bookings'])">
                      View My Bookings
                    </button>
                    <button class="btn btn-outline-primary" (click)="router.navigate(['/search'])">
                      Book Another Trip
                    </button>
                  </div>
                </div>
              </ng-template>
            </div>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card shadow sticky-top" style="top: 20px;">
            <div class="card-header bg-light">
              <h5 class="mb-0">Price Summary</h5>
            </div>
            <div class="card-body">
              <div class="d-flex justify-content-between mb-2">
                <span>Price per seat:</span>
                <span>KSh {{ busRoute.price }}</span>
              </div>
              <div class="d-flex justify-content-between mb-2">
                <span>Number of seats:</span>
                <span>{{ bookingData.seatsBooked }}</span>
              </div>
              <hr>
              <div class="d-flex justify-content-between fw-bold">
                <span>Total Amount:</span>
                <span>KSh {{ calculateTotal() }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>